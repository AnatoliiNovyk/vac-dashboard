# Audit & Plan: Vacation Dashboard

## Висновки аудиту

### 1. Формування вкладок (Ролі → Вкладки)

- **Локація:** Функція `getTabsForRole(role)` в `app.js`.
- **Логіка:** Функція генерує масив об'єктів вкладок на основі ролі поточного користувача (`hr`, `manager`, `employee`).
- **HR-head:** Для ролі 'hr' логіка коректно додає 3 вкладки, якщо у користувача є прапорець `is_hr_manager: true`:
    1.  `hr-all` (Всі співробітники)
    2.  `hr-manager` (Його підлеглі)
    3.  `hr-my` (Його відпустки)
    Це відповідає вимогам ТЗ.

### 2. Обчислення статусу

- **Локація:** Статуси зберігаються в масиві `appData.vacation_requests`.
- **Використання:**
    - `updateStatistics()`: Агрегує кількість заявок за кожним статусом.
    - `applyFilters()`: Фільтрує список заявок за обраним статусом.
    - `updateTable()`: Відображає статус у таблиці.
    - `approveVacation()` / `rejectVacation()`: Змінюють статус заявки на "Затверджено" або "Відхилено".
- **Відповідність ТЗ:** Поточна реалізація використовує 3 статуси ("В очікуванні", "Затверджено", "Відхилено"), що відповідає ТЗ.

### 3. Формування вибірки підлеглих

- **Локація:** Функція `getVacationsForCurrentTab()` в `app.js`.
- **Логіка:**
    - Для вкладок `hr-manager` та `manager-team` функція фільтрує масив `appData.employees` за полем `manager_id`, щоб знайти прямих підлеглих поточного менеджера.
    - Потім на основі ID підлеглих вибираються їхні заявки на відпустку.
- **Розрив відносно ТЗ:** Реалізовано лише вибірку **прямих** підлеглих (один рівень ієрархії). ТЗ вимагає "вертикаль", що передбачає перегляд усіх співробітників нижче за ієрархією (підлеглі підлеглих і т.д.).

## План наступних кроків

1.  **Розширити логіку вибірки підлеглих:**
    - Створити рекурсивну функцію `getSubordinates(managerId)`, яка буде збирати ID всіх співробітників у ієрархії під даним менеджером.
    - Оновити логіку у `getVacationsForCurrentTab()` для вкладок `hr-manager` та `manager-team`, щоб використовувати нову функцію для отримання повної вертикалі підлеглих.

2.  **Тестування:**
    - Перевірити, що для ролі "Manager" коректно відображаються заявки всієї його вертикалі.
    - Перевірити, що для "HR-head" у вкладці "Manager" також відображається повна вертикаль.
    - Переконатись, що для звичайного співробітника та в особистих вкладках логіка не змінилася.

Зміни коду на цьому етапі не потрібні. План буде реалізовано в наступних кроках.
